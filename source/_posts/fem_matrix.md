---
title: 结构力学有限元刚度矩阵的性质
tags: [fem]
categories: computational material science
date: 2016-10-08
---

# 引子
本文是对曾攀老师的《有限元分析及应用》和王勖成老师的《有限单元法》关于单元刚度矩阵和整体刚度矩阵部分的学习笔记。

刚度矩阵在有限元方法中占有最重要的位置，分析和了解其性质对于我们更深层次地掌握有限元法具有重要的作用。不同的方程对应不同的刚度矩阵，所以，具体刚度矩阵的性质需要针对具体的方程才能下定论。这里只对结构力学的刚度矩阵进行初探，以期对其他方程也能有更深的理解。

# 单元刚度矩阵的性质

## 性质1:矩阵元素具有明确物理意义
以一维2节点杆单元为例，其刚度方程为：
$$
\begin{bmatrix}
k\_{11} & k\_{12} \\\
k\_{21} & k\_{22}
\end{bmatrix}
\begin{bmatrix}
u\_1 \\\
u\_2
\end{bmatrix}
=
\begin{bmatrix}
f\_1 \\\
f\_2
\end{bmatrix}
$$
分两种情况进行具体讨论：
(1)考虑单元左端，即节点1，发生单位位移，而右端，即节点2，固定：
$$
u\_1=1,\qquad u\_2=0
$$
此时：
$$
k\_{11}=f\_1 
$$
这说明，$k\_{11}$是为保持这样一种状态，即使节点2的位移为0，使节点1产生单位位移，而需要在节点1上所施加的力。
推广到单元刚度矩阵的对角线元素，则有：
单元刚度矩阵的对角线元素$k\_{ii}$表示要使单元的第i个节点产生单位位移，而其他节点不动时，需在节点i上所施加的力。

同时，对角线元素还都大于0，因为在这个节点上，力与位移的方向必须相同，这是稳定的必然要求。

(2)考虑单元左端，即节点1，固定，而右端，即节点2，固定：
$$
u\_1=0,\qquad u\_2=1
$$
此时：
$$
k\_{12}=f\_1 
$$
这说明，$k\_{12}$是为保持这样一种状态，即使节点1的位移为0，使节点2产生单位位移，而需要在节点1上所施加的力。
推广到单元刚度矩阵的非对角线元素，则有：
单元刚度矩阵的非对角线元素$k\_{ji}(i\neq j)$表示要使单元的第j个节点产生单位位移，而其他节点不动时，需在节点i上所施加的力。

## 对称性
即：
$$
k\_{ij}=k\_{ji}
$$
因为：
$$
K^{eT}=[\int B^T D B d\Omega]^T=\int B^T D B d\Omega =K^e
$$

## 半正定性
这里先理清一个概念：刚体位移。以平面杆单元为例，它除了在原地变形，还可以有刚体位移。它的刚体位移包括两个方向的移动和一个面内的转动。
将基于节点表达的应变能展开：
$$
\begin{split}
U&=\frac{1}{2}q^{eT}K^e q^e \\\
&=\frac{1}{2}(k\_{11}u\_1^2+...+k\_{1i}u\_1 u\_i+...+k\_{1n}u\_1 u\_n + ... \\\
             +k\_{j1}u\_j^2+...+k\_{ji}u\_j u\_i+...+k\_{jn}u\_j u\_n + ... \\\
             +k\_{n1}u\_n^2+...+k\_{ni}u\_n u\_i+...+k\_{nn}u\_n u\_n) \\\
&=\frac{1}{2}\sum\_{i=1}^{n}\sum\_{j=1}^{n}k\_{ij}u\_i u\_j
\end{split}
$$
其中，$q^e=[u\_1 u\_2 ... u\_n]^T$代表节点位移。
上式表明：应变能是位移的二次齐次多项式。在线性代数里，上式被称为矩阵$K^e$的二次型。
分两种情形考虑：
(1)不考虑刚体位移：不论位移列阵取何值，除非没有位移，因为应变能为一种能量，所以应变能总是正值。所以，此时，矩阵$K^e$是正定矩阵。
(2)考虑刚体位移：此时位移列阵不为0，因为刚体位移也是位移。而此时如果单元没有变形，那么应变能为0，那么只能$|K^e|=0$。

综上两种情形，矩阵$K^e$是半正定的。

## 奇异性
假设一个单元在受相同外载的情形下存在两种状态位移，即该单元可以任意移动，但所受的力是保持平衡的。仍以之前的一维杆单元为例说明。
在节点载荷$(f\_1,f\_2)$作用下，该单元有位移：
$$
\begin{split}
u\_1 &= c\_1^{(1)} \\\
u\_2 &= c\_2^{(1)}
\end{split}
$$
假设该单元在保持$(f\_1,f\_2)$作用下有一刚体位移，则此时位移有：
$$
\begin{split}
u\_1 &= c\_1^{(1)}+u\_0 = c\_1^{(2)} \\\
u\_2 &= c\_2^{(1)}+u\_0 = c\_2^{(2)}
\end{split}
$$
则对应于以上两种情形的单元刚度方程为：
$$
\begin{split}
\begin{bmatrix}
k\_{11} & k\_{12} \\\
k\_{21} & k\_{22}
\end{bmatrix}
\begin{bmatrix}
c\_1^{(1)} \\\
c\_2^{(1)}
\end{bmatrix}
&=
\begin{bmatrix}
f\_1 \\\
f\_2
\end{bmatrix}  \\\
\begin{bmatrix}
k\_{11} & k\_{12} \\\
k\_{21} & k\_{22}
\end{bmatrix}
\begin{bmatrix}
c\_1^{(2)} \\\
c\_2^{(2)}
\end{bmatrix}
&=
\begin{bmatrix}
f\_1 \\\
f\_2
\end{bmatrix} 
\end{split}
$$
两式相减，有：
$$
\begin{bmatrix}
k\_{11} & k\_{12} \\\
k\_{21} & k\_{22}
\end{bmatrix}
\begin{bmatrix}
c\_1^{(2)}-c\_1^{(1)} \\\
c\_2^{(2)}-c\_2^{(1)}
\end{bmatrix}
=
\begin{bmatrix}
0 \\\
0
\end{bmatrix}  
$$
由于刚体位移平移量$u\_0$不为零，所以上式有非零解的条件是矩阵奇异。

即：给定节点载荷，即使它们满足平衡，却不能由该方程确定单元节点位移，这是因为单元还可以有任意的刚体位移。

# 整体刚度矩阵的性质
由单元刚度矩阵组装起来的整体刚度矩阵具有以下性质：
## 任一元素具有物理意义
任一元素$k\_{ji}(i\neq j)$表示要使单元的第j个节点产生单位位移，而其他节点不动时，需在节点i上所施加的力。
与单元不同之处在于：整体是单元的集合，每个单元都对整体起一定的作用。

## 对称性
## 半正定性
## 奇异性
## 大型稀疏矩阵
当连续体离散为有限个单元时，每个节点的相关单元只是围绕在该节点周围为数很少的几个，一个节点通过相关单元与之发生关系的相关节点也只是周围的少数几个，因此虽然整体单元数和节点数很多，整体刚度矩阵的阶数很高，但刚度系数中非零系数却很少，这就是刚度矩阵的大型和稀疏性。

## 非零元素呈带状分布
当节点编号合理时，稀疏的非零元素将集中在以主对角线为中心的带状区域内，即呈现带状分布的特点。

# 位移边界条件的作用
由于刚度矩阵是奇异的，所以求解方程时，除了力的施加不当造成无解的情形(即力不在刚度矩阵的列空间内)外，会有无穷解。解的维数取决于自由变量的个数。
为了消除奇异性，需要引入位移边界条件，让其填充自由变量的位置，从而获得唯一解。
从物理图像上理解，就是位移边界条件限制了刚体位移，从而使位移量唯一。

# 其他方程的刚度矩阵的性质
其他方程不一定与上述结构力学的刚度方程的性质相同。
比如NS方程，由于其有对流项，其刚度矩阵是非对称的。
比如Possion方程，其刚度矩阵直接就是正定的？见这个[讨论](http://scicomp.stackexchange.com/questions/21423/in-fem-why-is-the-stiffness-matrix-positive-definite)。
所以一句话，具体问题具体分析。
